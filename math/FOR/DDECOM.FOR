      SUBROUTINE DECOMP(NDIM,N,A,COND,IPVT,WORK)
C
      INTEGER NDIM,N
      REAL*8 A(NDIM,N),COND,WORK(N)
      INTEGER IPVT(N)
C
C     POPAMMA BCET PAOEHE BEECTBEHHO MATP
C     OCPECTBOM ACCOBA CKEH  OEHBAET
C     OCOBEHHOCT  MATP.
C
C     OHA COETC  BCEH PEEH
C     HEHX CCTEM.
C
C     BXOHA HOPMA.
C
C     NDIM -ABEHHA CTPOHA PAMEPHOCT MACCBA,
C           COEPAEO A.
C
C     N    -OPOK MATP.
C
C     A    -MATPA,KOTOP HHO PAOT.
C
C     BXOHA HOPMA.
C
C     A     COEPT BEPXH TPEOH MATP U
C            TBA EPECTAHOBK BEPC
C           HHE TPEOHO MATP I-L,TAKE,
C           TO (MATPA  EPECTAHOBOK) *A=L*U
C
C     COND -OEHKA OCOBEHHOCT A.
C            HEHO CCTEM A*X=B MEHEH B A  B
C           MOT BBAT  MEHEH B X,OE B COND PA.
C           EC COND+1.0.EQ.COND, TO  A B PEEAX MAHHO
C           TOHOCT BETC BPOEHHO MATPE. COND
C           OAAETC PABHM 1.0E+32,EC OHAPEHA TOHA
C           BPOEHHOCT.
C
C     IPVT -BEKTOP BEX EMEHTOB.
C           IPVT(K)=HEKC K- BEE CTPOK
C           IPVT(N)=(-1)**(CO EPECTAHOBOK)
C
C     PAOEE OE. BEKTOP WORK OEH T OCAH 
C             BKEH B BOB. EO BXOHOE COEPAHE OHO
C             HE AET BAHO HOPMA.
C
C     OPEETE MATP A MOET T OEH HA BXOE
C     O OPME:
C          DET(A)=IPVT(N)*A(1,1)*A(2,2)*...*A(N,N).
C
      REAL*8 EK,T,ANORM,YNORM,ZNORM
      INTEGER NM1,I,J,K,KP1,KB,KM1,M
C
      IPVT(N)=1
      IF(N.EQ.1)GO TO 80
      NM1=N-1
C
C     BCT 1-HOPM MATP A
C
      ANORM=0.0D+00
      DO 10 J=1,N
        T=0.0D+00
        DO 5 I=1,N
          T=T+DABS(A(I,J))
    5   CONTINUE
        IF(T.GT.ANORM) ANORM=T
   10 CONTINUE
C
C     ACCOBO CKEHE C ACTHM BOPOM
C     BEEO EMEHTA
C
      DO 35 K=1,NM1
        KP1=K+1
C
C       HAT BE EMEHT
C
        M=K
        DO 15 I=KP1,N
          IF(DABS(A(I,K)).GT.DABS(A(M,K))) M=I
   15   CONTINUE
        IPVT(K)=M
        IF(M.NE.K)IPVT(N)=-IPVT(N)
        T=A(M,K)
        A(M,K)=A(K,K)
        A(K,K)=T
C
C       POCTT TOT A,EC BE EMEHT PABEH H
C
        IF(T.EQ.0.0D+00)GO TO 35
C
C       BCT MHOTE
C
        DO 20 I=KP1,N
          A(I,K)=-A(I,K)/T
   20   CONTINUE
C
C       EPECTABT  CKAT O CTOAM
C
        DO 30 J=KP1,N
          T=A(M,J)
          A(M,J)=A(K,J)
          A(K,J)=T
          IF(T.EQ.0.0D+00)GO TO 30
          DO 25 I=KP1,N
            A(I,J)=A(I,J)+A(I,K)*T
   25     CONTINUE
   30   CONTINUE
   35 CONTINUE
C
C     COND=(1-HOPMA MATP A)*(OEHKA  1-HOPM MATP,
C     OPATHO K A)
C     OEHKA OAETC OCPECTBOM OHOO AA METOA
C     OPATHX TEPA  HAMEHEO CHPHOO
C     BEKTOPA. TO TPEET PEEH BX CCTEM PABHEH,
C     (TPAHCOHPOBAHHA  A) *Y=E  A*Z=Y, E E-BEKTOP
C      +1  -1, BPAHH TAK, TO MAKCMPOBAT
C     BEH Y.
C     ESTIMATE=(1-HOPMA Z)/(1-HOPMA Y)
C
C     PET CCTEM (TPAHCOHPOBAHHA  A)*Y=E
C
      DO 50 K=1,N
        T=0.0D+00
        IF(K.EQ.1)GO TO 45
        KM1=K-1
        DO 40 I=1,KM1
          T=T+A(I,K)*WORK(I)
   40   CONTINUE
   45   EK=1.0D+00
        IF(T.LT.0.0D+00) EK=-1.0D+00
        IF(A(K,K).EQ.0.0D+00)GO TO 90
        WORK(K)=-(EK+T)/A(K,K)
   50 CONTINUE
      DO 60 KB=1,NM1
        K=N-KB
        T=WORK(K)
        KP1=K+1
        DO 55 I=KP1,N
          T=T+A(I,K)*WORK(I)
   55   CONTINUE
        WORK(K)=T
        M=IPVT(K)
        IF(M.EQ.K)GO TO 60
        T=WORK(M)
        WORK(M)=WORK(K)
        WORK(K)=T
   60 CONTINUE
C
      YNORM=0.0D+00
      DO 65 I=1,N
        YNORM=YNORM+DABS(WORK(I))
   65 CONTINUE
C
C     PET CCTEM A*Z=Y
C
      CALL DSOLVE(NDIM,N,A,WORK,IPVT)
C
      ZNORM=0.0D+00
      DO 70 I=1,N
        ZNORM=ZNORM+DABS(WORK(I))
   70 CONTINUE
C
C     OEHT OCOBEHHOCT
C
      COND=ANORM*ZNORM/YNORM
      IF(COND.LT.1.0D+00) COND=1.0D+00
      RETURN
C
C     CA MATP 1*1
C
   80 COND=1.0D+00
      IF(A(1,1).NE.0.0D+00)RETURN
C
C     TOHA BPOEHHOCT
C
   90 CONTINUE
      COND=1.0D+64
      RETURN
      END
