      REAL FUNCTION URAND(IY)
      INTEGER IY
C
C       URAND-TO ATK PABHOMEPHO PACPEEEHHX CAHX
C     CE, OCHOBAHH HA TEOP  PEOEHX, COEPAXC
C     B KHE KHT (1969),TOM 2.
C       EPE EPBM OPAEHEM K URAND EO EPEMEHHO IY
C     CEET PCBOT POBOHOE EOCEHHOE HAA-
C     HOE HAEHE. BBAA POPAMMA HE OHA MEHT
C     HAEHE IY ME OCEOBATEHM BOBAM. HAEH
C     HK URAND BTC CAM  HTEPBAA (0,1).
C
      INTEGER IA,IC,ITWO,M2,M,MIC
      DOUBLE PRECISION HALFM
      REAL S
      DOUBLE PRECISION DATAN,DSQRT
      DATA M2/0/,ITWO/2/
      IF(M2.NE.0) GOTO 20
C
C     EC TO EPB BXO, TO BCT H
C     EOCEHHOO MAHHOO COBA
C
      M=1
   10 M2=M
      M=ITWO*M2
      IF(M .GT. M2) GO TO 10
      HALFM=M2
C
C     BCT MHOTE  PPAEHE HEHOO
C     KOHPHTHOO METOA
C
      IA=8*IDINT(HALFM*DATAN(1.D0)/8.D0)+5
      IC=2*IDINT(HALFM*(0.5D0-DSQRT(3.D0)/6.D0))+1
      MIC=(M2-IC)+M2
C
C     S-MACTAP MHOTE  PEOPAOBAH B CO
C     C ABAE TOKO
C
      S=0.5/HALFM
C
C     BCT CEEE CAHOE CO
C
   20 IY=IY*IA
C
C     CE OEPATOP- MAH,KOTOPE HE OCKAT
C     EPEOHEH EX CE P COEH
C
      IF(IY.GT.MIC) IY=(IY-M2)-M2
      IY=IY+IC
C
C     CE OEPATOP -  MAH,  KOTOPX HA COBA
C      COEH OE, EM  MHOEH
C
      IF(IY/2.GT.M2) IY=(IY-M2)-M2
C
C     CE OEPATOP -  MAH,  KOTOPX EPEOHEHE
C     EOO CA BET HA HAKOB PAP
C
      IF(IY.LT.0) IY=(IY+M2)+M2
      URAND=FLOAT(IY)*S
      RETURN
      END
